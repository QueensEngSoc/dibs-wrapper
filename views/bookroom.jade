extends layout

block content
    //h1= title
    //p Showing Information for Room #{jaderoom}
    div.header
        div.container
            div.logo
                h1
                    a(href='/' style='color: #fff; text-decoration: none;')
                        img.className#IdName(src="/html/logo.png" alt="Image Title" width='40' height='50')
                        | &nbsp#{title}
            div.nav
                ul
                    a(href="/map" style='color: #fff; text-decoration: none;')
                        li
                             |MAP
                        li
                             img(src="/html/mapfix.png" width="50" height="25")

    div(style="margin-top: 100px;")
    br

    div.row
        div.col
            p Looking at room #{jaderoom} for #{jadedate}
            p There are #{count} bookings for this room today
            if jadeRoomFreeNow == true
                p This room is currently free
            else
                p This room is currently booked
        div.col
            img(src="#{jadeRoomPicUrl}" alt='"ILC Room #{jaderoom}"' height='150')

    br
    if count > 0
        //display the following if there is at least one booking today
        p Room booking info:

        table.table.table-striped.table-bordered.table-hover.table-condensed(style="width:85%; margin: auto")
            thead
                tr
                    th Booking Length (Hours)
                    th Start Time
                    th End Time
            tbody
                    for res in jadeJson
                        tr
                            td= res.bookingLength
                            td= res.bookingStart
                            td= res.bookingEnd

    br

    button(name='dibsBookBtn', type='submit', class='.btn-primary', style='margin-left: 100px; ', onclick='dibsRoomBookClick()', enabled) Book This Room

    br
    br

    script.
        function dibsRoomBookClick(){
            // this function gets the current room id, embeds it into the post request, and then sends a post.
            // On success, it returns whether the booking was successful, or the error that occurred
            $.ajax({
                url: "/bookroom",
                type: "POST",
                data: JSON.stringify(#{jadeRoomID}),
                success: function (result) {
                    console.log("result value is: " + result);
                    document.getElementById('dibsFrame').src = result;
                }
            });
        }

//https://stackoverflow.com/questions/6170925/get-dom-content-of-cross-domain-iframe
